

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->

<!-- Mirrored from learn.foundry.com/modo/developers/latest/sdk/pages/tutorials/Reading Persistant Data.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 30 Nov 2024 03:16:09 GMT -->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Reading Persistant Data &mdash; Modo SDK 14.2v0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/js/contentui.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Reading UV Values in Python" href="Reading%20UV%20Values.html" />
    <link rel="prev" title="Reading Files with Python" href="Reading%20Files%20with%20Python.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Modo SDK
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="https://learn.foundry.com/modo/developers/latest/sdk/search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Articles</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../starting/_starting.html">First Steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server_basics/_server_basics.html">Server Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/_general.html">Editorial Info</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ui/_ui.html">User Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripting/_scripting.html">Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faqs/_faqs.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption"><span class="caption-text">Code Examples</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="_tutorials.html">SDK Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Channel%20Mod%20Linear%20Blend.html">Channel Mod Linear Blend</a></li>
<li class="toctree-l2"><a class="reference internal" href="Channel%20Mod%20Math%20Multi.html">Channel Mod Math Multi</a></li>
<li class="toctree-l2"><a class="reference internal" href="Channel%20Mod%20Simple%20Kinematics.html">Channel Mod Simple Kinematics</a></li>
<li class="toctree-l2"><a class="reference internal" href="Color%20Model%20HSV.html">Color Model HSV</a></li>
<li class="toctree-l2"><a class="reference internal" href="Colormodel%20kelvin.html">Colormodel kelvin</a></li>
<li class="toctree-l2"><a class="reference internal" href="Command%20VertValue.html">Command VertValue</a></li>
<li class="toctree-l2"><a class="reference internal" href="Creating%20a%20Selection%20Set.html">Creating a Selection Set</a></li>
<li class="toctree-l2"><a class="reference internal" href="CustomView.html">CustomView</a></li>
<li class="toctree-l2"><a class="reference internal" href="Hello%20World.html">Hello World</a></li>
<li class="toctree-l2"><a class="reference internal" href="HostService%20Reference.html">HostService Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="Io%20image%20raw.html">Io image raw</a></li>
<li class="toctree-l2"><a class="reference internal" href="Io%20scene%20geo.html">Io scene geo</a></li>
<li class="toctree-l2"><a class="reference internal" href="Io%20scene%20hgpl.html">Io scene hgpl</a></li>
<li class="toctree-l2"><a class="reference internal" href="Item%20Command%20Arguments.html">Item Command Arguments</a></li>
<li class="toctree-l2"><a class="reference internal" href="Item%20gasket.html">Item gasket</a></li>
<li class="toctree-l2"><a class="reference internal" href="Item%20mandelbrot.html">Item mandelbrot</a></li>
<li class="toctree-l2"><a class="reference internal" href="Item%20orb.html">Item orb</a></li>
<li class="toctree-l2"><a class="reference internal" href="Language%20Wrappers.html">Language Wrappers</a></li>
<li class="toctree-l2"><a class="reference internal" href="Mesh%20Operation%20-%20Automatic%20implementation.html">Mesh Operation - Automatic implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Mesh%20Operation%20-%20Example.html">Mesh Operation - Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="Mesh%20Operation%20-%20Manual%20implementation.html">Mesh Operation - Manual implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Modo%20Version%20History.html">Modo Version History</a></li>
<li class="toctree-l2"><a class="reference internal" href="Movie%20cocoaqt.html">Movie cocoaqt</a></li>
<li class="toctree-l2"><a class="reference internal" href="Multiple%20Servers%20in%20One%20Module.html">Multiple Servers in One Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="Network%20Rendering.html">Network Rendering</a></li>
<li class="toctree-l2"><a class="reference internal" href="Package%20or%20Item%20Type%20(metaclass).html">Package or Item Type (metaclass)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Path%20Aliases.html">Path Aliases</a></li>
<li class="toctree-l2"><a class="reference internal" href="Pattern%20Matching.html">Pattern Matching</a></li>
<li class="toctree-l2"><a class="reference internal" href="PlatformService%20Reference.html">PlatformService Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="Plug-ins%20vs.%20Scripts.html">Plug-ins vs. Scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="Pop-up%20List%20Choice.html">Pop-up List Choice</a></li>
<li class="toctree-l2"><a class="reference internal" href="Preference%20Forms.html">Preference Forms</a></li>
<li class="toctree-l2"><a class="reference internal" href="Prepare_Evaluate%20Protocol.html">Prepare/Evaluate Protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="Preset%20Browser%20Filtering.html">Preset Browser Filtering</a></li>
<li class="toctree-l2"><a class="reference internal" href="Preset%20Browser%20Paths.html">Preset Browser Paths</a></li>
<li class="toctree-l2"><a class="reference internal" href="Preview%20Socket.html">Preview Socket</a></li>
<li class="toctree-l2"><a class="reference internal" href="Procedural%20Geometry.html">Procedural Geometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="Python.html">Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="Python%20API%20Overview.html">Python API Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="Python%20Command%20Overview.html">Python Command Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="Python%20Notifier%20Example.html">Python Notifier Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="Python%20Samples.html">Python Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="Python%20Treeview%20Example.html">Python Treeview Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="Python%20in%20Modo.html">Python in Modo</a></li>
<li class="toctree-l2"><a class="reference internal" href="Query%20Command%20Values%20example.html">Query Command Values example</a></li>
<li class="toctree-l2"><a class="reference internal" href="RandomSel%20Script.html">RandomSel Script</a></li>
<li class="toctree-l2"><a class="reference internal" href="Reading%20Files%20with%20Python.html">Reading Files with Python</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Reading Persistant Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#defining-xml-data">Defining XML Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-code">Example Code</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#p3dpersistence-setup">P3DPersistence_Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#readpersistent-lod-data">ReadPersistent_LoD_Data</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#additional-info">Additional Info</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Reading%20UV%20Values.html">Reading UV Values in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="Render%20Frame%20Size.html">Render Frame Size</a></li>
<li class="toctree-l2"><a class="reference internal" href="Scene%20Query.cpp.html">Scene Query.cpp</a></li>
<li class="toctree-l2"><a class="reference internal" href="Select.typeFrom.html">Select.typeFrom</a></li>
<li class="toctree-l2"><a class="reference internal" href="Selection%20Operation%20-%20Automatic%20implementation.html">Selection Operation - Automatic implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Selection%20Operation%20-%20Manual%20implementation.html">Selection Operation - Manual implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Server%20Tags.html">Server Tags</a></li>
<li class="toctree-l2"><a class="reference internal" href="Singleton%20Listener.html">Singleton Listener</a></li>
<li class="toctree-l2"><a class="reference internal" href="Singleton%20Polymorph.html">Singleton Polymorph</a></li>
<li class="toctree-l2"><a class="reference internal" href="Startup%20Commands.html">Startup Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="Symbols%20defined%20in%20the%20lx%20package.html">Symbols defined in the lx package</a></li>
<li class="toctree-l2"><a class="reference internal" href="Texture%20test.html">Texture test</a></li>
<li class="toctree-l2"><a class="reference internal" href="Tool%20spikey.html">Tool spikey</a></li>
<li class="toctree-l2"><a class="reference internal" href="Using%20Loader%20Options.html">Using Loader Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="Writing%20to%20the%20Event%20Log.html">Writing to the Event Log</a></li>
<li class="toctree-l2"><a class="reference internal" href="Writing%20to%20the%20modo%20event%20log%20and%20debugger.html">Writing to the modo event log and debugger</a></li>
<li class="toctree-l2"><a class="reference internal" href="Your%20First%20Tool%20in%20Modo.html">Your First Tool in Modo</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples/_examples.html">Code Examples and Snippets</a></li>
</ul>
<p class="caption"><span class="caption-text">Technical Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../python/python.html">Python Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cpp/cpp.html">C++ Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Modo SDK</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="_tutorials.html">SDK Tutorials</a> &raquo;</li>
        
      <li>Reading Persistant Data</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="reading-persistant-data">
<h1>Reading Persistant Data<a class="headerlink" href="#reading-persistant-data" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id7">Introduction</a></p></li>
<li><p><a class="reference internal" href="#defining-xml-data" id="id8">Defining XML Data</a></p></li>
<li><p><a class="reference internal" href="#example-code" id="id9">Example Code</a></p>
<ul>
<li><p><a class="reference internal" href="#p3dpersistence-setup" id="id10">P3DPersistence_Setup</a></p></li>
<li><p><a class="reference internal" href="#readpersistent-lod-data" id="id11">ReadPersistent_LoD_Data</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#additional-info" id="id12">Additional Info</a></p></li>
</ul>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id7">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The objective of this article is to describe in laymans terms reading persistant xml data from the configuration files you might employ with your plugin. Primarily, I’ll discuss the usage of the</p>
<p>: Persist_(lx-persist.hpp)#.287.29_User_Service_Class:_PersistenceService_method</p>
<p>method for retrieving unique data that you may have stored and that doesn’t fit well with the CLxReadUserValue_(index) or ‘CLxReadPreferenceValue’ senario.</p>
<p>The basic usage premise of CLxUser_PersistenceService.ConfigureVis is that the ‘service’ finds the ‘root’ &lt;atom&gt; you specify in the 1st parameter and the Evaluate method of the simple visitor you pass as the 2nd parameter initializes the accessor objects and their implicit heirarchy into various CLxUser_PersistentEntry objects.</p>
</div>
<div class="section" id="defining-xml-data">
<h2><a class="toc-backref" href="#id8">Defining XML Data</a><a class="headerlink" href="#defining-xml-data" title="Permalink to this headline">¶</a></h2>
<p>Sometimes when developing a .lx plugin you want to have stored data that you can easily modifiy and/or extend. Generally you will package your plugin as a Kits with an included config.cfg xml file for detailing your plugins forms, messages, help &amp; user values etc.</p>
<p>There are 3 types of xml elements one may define. An &lt;atom&gt;, &lt;list&gt;, or a &lt;hash&gt;. See the Persist_(lx-persist.hpp)#.283.29_SDK:_ILxPersistenceService_interface page for more on this.</p>
<p>As an example I’ve written a file i/o plugin that reads &amp; writes a proprietry binary model file format for a gaming engine. During saving a .lxo scene the saver code looks for visible meshs gathering the names of these meshes. Then the plugin looks up these mesh names in a std::map&lt;string, int&gt; container. Vice versus, when reading the model file the loader portion of the plugin needs to deduce an appropriate name for the ‘lod’ being read so that it may name a new mesh appropriately in the modo scene. It does this by looking up the integer value of the lod read in a std::map&lt;int, string&gt; container.</p>
<p>To facilitate this mechanism I created the following xml fragment in the config file for the kit.</p>
<div class="highlight-xml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nt">&lt;code&gt;</span>
  <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;sy_p3d&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;lods&quot;</span><span class="nt">&gt;</span>
      <span class="c">&lt;!-- NOTE: LoD Names maximum length of 256 chars --&gt;</span>
      <span class="nt">&lt;list</span> <span class="na">type=</span><span class="s">&quot;lod&quot;</span><span class="nt">&gt;</span>        <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>ViewCommander<span class="nt">&lt;/atom&gt;</span>               <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;value&quot;</span><span class="nt">&gt;</span>1510874058<span class="nt">&lt;/atom&gt;</span>      <span class="nt">&lt;/list&gt;</span>
      <span class="nt">&lt;list</span> <span class="na">type=</span><span class="s">&quot;lod&quot;</span><span class="nt">&gt;</span>        <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>ViewCommanderGeometry<span class="nt">&lt;/atom&gt;</span>       <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;value&quot;</span><span class="nt">&gt;</span>1511805380<span class="nt">&lt;/atom&gt;</span>      <span class="nt">&lt;/list&gt;</span>
      <span class="nt">&lt;list</span> <span class="na">type=</span><span class="s">&quot;lod&quot;</span><span class="nt">&gt;</span>        <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>ViewCommanderFireGeometry<span class="nt">&lt;/atom&gt;</span>   <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;value&quot;</span><span class="nt">&gt;</span>1512736703<span class="nt">&lt;/atom&gt;</span>      <span class="nt">&lt;/list&gt;</span>
      <span class="nt">&lt;list</span> <span class="na">type=</span><span class="s">&quot;lod&quot;</span><span class="nt">&gt;</span>        <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>ViewGunner<span class="nt">&lt;/atom&gt;</span>                  <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;value&quot;</span><span class="nt">&gt;</span>1148846080<span class="nt">&lt;/atom&gt;</span>      <span class="nt">&lt;/list&gt;</span>
      <span class="nt">&lt;list</span> <span class="na">type=</span><span class="s">&quot;lod&quot;</span><span class="nt">&gt;</span>        <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>ViewGunnerGeometry<span class="nt">&lt;/atom&gt;</span>          <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;value&quot;</span><span class="nt">&gt;</span>1515530671<span class="nt">&lt;/atom&gt;</span>      <span class="nt">&lt;/list&gt;</span>
      <span class="nt">&lt;list</span> <span class="na">type=</span><span class="s">&quot;lod&quot;</span><span class="nt">&gt;</span>        <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>ViewGunnerFireGeometry<span class="nt">&lt;/atom&gt;</span>      <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;value&quot;</span><span class="nt">&gt;</span>1512736703<span class="nt">&lt;/atom&gt;</span>      <span class="nt">&lt;/list&gt;</span>
      <span class="nt">&lt;list</span> <span class="na">type=</span><span class="s">&quot;lod&quot;</span><span class="nt">&gt;</span>        <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>ViewPilot<span class="nt">&lt;/atom&gt;</span>                   <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;value&quot;</span><span class="nt">&gt;</span>1149861888<span class="nt">&lt;/atom&gt;</span>      <span class="nt">&lt;/list&gt;</span>
      <span class="nt">&lt;list</span> <span class="na">type=</span><span class="s">&quot;lod&quot;</span><span class="nt">&gt;</span>        <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>ViewPilotGeometry<span class="nt">&lt;/atom&gt;</span>           <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;value&quot;</span><span class="nt">&gt;</span>1513668025<span class="nt">&lt;/atom&gt;</span>      <span class="nt">&lt;/list&gt;</span>
      <span class="nt">&lt;list</span> <span class="na">type=</span><span class="s">&quot;lod&quot;</span><span class="nt">&gt;</span>        <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>ViewPilotFireGeometry<span class="nt">&lt;/atom&gt;</span>       <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;value&quot;</span><span class="nt">&gt;</span>1514599348<span class="nt">&lt;/atom&gt;</span>      <span class="nt">&lt;/list&gt;</span>
      <span class="nt">&lt;list</span> <span class="na">type=</span><span class="s">&quot;lod&quot;</span><span class="nt">&gt;</span>        <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>ViewCargo<span class="nt">&lt;/atom&gt;</span>                   <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;value&quot;</span><span class="nt">&gt;</span>1150681088<span class="nt">&lt;/atom&gt;</span>      <span class="nt">&lt;/list&gt;</span>
      <span class="nt">&lt;list</span> <span class="na">type=</span><span class="s">&quot;lod&quot;</span><span class="nt">&gt;</span>        <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>ViewCargoGeometry<span class="nt">&lt;/atom&gt;</span>           <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;value&quot;</span><span class="nt">&gt;</span>1508073385<span class="nt">&lt;/atom&gt;</span>      <span class="nt">&lt;/list&gt;</span>
      <span class="nt">&lt;list</span> <span class="na">type=</span><span class="s">&quot;lod&quot;</span><span class="nt">&gt;</span>        <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>ViewCargoFireGeometry<span class="nt">&lt;/atom&gt;</span>       <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;value&quot;</span><span class="nt">&gt;</span>1509936030<span class="nt">&lt;/atom&gt;</span>      <span class="nt">&lt;/list&gt;</span>
      <span class="nt">&lt;list</span> <span class="na">type=</span><span class="s">&quot;lod&quot;</span><span class="nt">&gt;</span>        <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>ViewGeometry<span class="nt">&lt;/atom&gt;</span>                <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;value&quot;</span><span class="nt">&gt;</span>1504348095<span class="nt">&lt;/atom&gt;</span>      <span class="nt">&lt;/list&gt;</span>
      <span class="nt">&lt;list</span> <span class="na">type=</span><span class="s">&quot;lod&quot;</span><span class="nt">&gt;</span>        <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>FireGeometry<span class="nt">&lt;/atom&gt;</span>                <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;value&quot;</span><span class="nt">&gt;</span>1506210740<span class="nt">&lt;/atom&gt;</span>      <span class="nt">&lt;/list&gt;</span>
      <span class="nt">&lt;list</span> <span class="na">type=</span><span class="s">&quot;lod&quot;</span><span class="nt">&gt;</span>        <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Geometry<span class="nt">&lt;/atom&gt;</span>                    <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;value&quot;</span><span class="nt">&gt;</span>1427211495<span class="nt">&lt;/atom&gt;</span>      <span class="nt">&lt;/list&gt;</span>
      <span class="nt">&lt;list</span> <span class="na">type=</span><span class="s">&quot;lod&quot;</span><span class="nt">&gt;</span>        <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Memory<span class="nt">&lt;/atom&gt;</span>                      <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;value&quot;</span><span class="nt">&gt;</span>1482907561<span class="nt">&lt;/atom&gt;</span>      <span class="nt">&lt;/list&gt;</span>
      <span class="nt">&lt;list</span> <span class="na">type=</span><span class="s">&quot;lod&quot;</span><span class="nt">&gt;</span>        <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>LandContact<span class="nt">&lt;/atom&gt;</span>                 <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;value&quot;</span><span class="nt">&gt;</span>1491296169<span class="nt">&lt;/atom&gt;</span>      <span class="nt">&lt;/list&gt;</span>
      <span class="nt">&lt;list</span> <span class="na">type=</span><span class="s">&quot;lod&quot;</span><span class="nt">&gt;</span>        <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Roadway<span class="nt">&lt;/atom&gt;</span>                     <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;value&quot;</span><span class="nt">&gt;</span>1495959487<span class="nt">&lt;/atom&gt;</span>      <span class="nt">&lt;/list&gt;</span>
      <span class="nt">&lt;list</span> <span class="na">type=</span><span class="s">&quot;lod&quot;</span><span class="nt">&gt;</span>        <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Paths<span class="nt">&lt;/atom&gt;</span>                       <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;value&quot;</span><span class="nt">&gt;</span>1499684777<span class="nt">&lt;/atom&gt;</span>      <span class="nt">&lt;/list&gt;</span>
      <span class="nt">&lt;list</span> <span class="na">type=</span><span class="s">&quot;lod&quot;</span><span class="nt">&gt;</span>        <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Hitpoints<span class="nt">&lt;/atom&gt;</span>                   <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;value&quot;</span><span class="nt">&gt;</span>1502485450<span class="nt">&lt;/atom&gt;</span>      <span class="nt">&lt;/list&gt;</span>
      <span class="nt">&lt;list</span> <span class="na">type=</span><span class="s">&quot;lod&quot;</span><span class="nt">&gt;</span>        <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Subparts<span class="nt">&lt;/atom&gt;</span>                    <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;value&quot;</span><span class="nt">&gt;</span>1517393316<span class="nt">&lt;/atom&gt;</span>      <span class="nt">&lt;/list&gt;</span>
      <span class="nt">&lt;list</span> <span class="na">type=</span><span class="s">&quot;lod&quot;</span><span class="nt">&gt;</span>        <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>ShadowVolume-ViewCargo<span class="nt">&lt;/atom&gt;</span>      <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;value&quot;</span><span class="nt">&gt;</span>1518324638<span class="nt">&lt;/atom&gt;</span>      <span class="nt">&lt;/list&gt;</span>
      <span class="nt">&lt;list</span> <span class="na">type=</span><span class="s">&quot;lod&quot;</span><span class="nt">&gt;</span>        <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>ShadowVolume-ViewPilot<span class="nt">&lt;/atom&gt;</span>      <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;value&quot;</span><span class="nt">&gt;</span>1518797004<span class="nt">&lt;/atom&gt;</span>      <span class="nt">&lt;/list&gt;</span>
      <span class="nt">&lt;list</span> <span class="na">type=</span><span class="s">&quot;lod&quot;</span><span class="nt">&gt;</span>        <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>ShadowVolume-ViewGunner<span class="nt">&lt;/atom&gt;</span>     <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;value&quot;</span><span class="nt">&gt;</span>1519262666<span class="nt">&lt;/atom&gt;</span>      <span class="nt">&lt;/list&gt;</span>
      <span class="nt">&lt;list</span> <span class="na">type=</span><span class="s">&quot;lod&quot;</span><span class="nt">&gt;</span>        <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Wreck<span class="nt">&lt;/atom&gt;</span>                       <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;value&quot;</span><span class="nt">&gt;</span>1519728327<span class="nt">&lt;/atom&gt;</span>      <span class="nt">&lt;/list&gt;</span>
      <span class="nt">&lt;list</span> <span class="na">type=</span><span class="s">&quot;lod&quot;</span><span class="nt">&gt;</span>        <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>ShadowVolume0.0<span class="nt">&lt;/atom&gt;</span>             <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;value&quot;</span><span class="nt">&gt;</span>1176256512<span class="nt">&lt;/atom&gt;</span>      <span class="nt">&lt;/list&gt;</span>
      <span class="nt">&lt;list</span> <span class="na">type=</span><span class="s">&quot;lod&quot;</span><span class="nt">&gt;</span>        <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>ShadowVolume10.0<span class="nt">&lt;/atom&gt;</span>            <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;value&quot;</span><span class="nt">&gt;</span>1176266752<span class="nt">&lt;/atom&gt;</span>      <span class="nt">&lt;/list&gt;</span>
      <span class="nt">&lt;list</span> <span class="na">type=</span><span class="s">&quot;lod&quot;</span><span class="nt">&gt;</span>        <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Displacement<span class="nt">&lt;/atom&gt;</span>                <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;value&quot;</span><span class="nt">&gt;</span>1435600103<span class="nt">&lt;/atom&gt;</span>      <span class="nt">&lt;/list&gt;</span>
      <span class="nt">&lt;list</span> <span class="na">type=</span><span class="s">&quot;lod&quot;</span><span class="nt">&gt;</span>        <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Underground<span class="nt">&lt;/atom&gt;</span>                 <span class="nt">&lt;atom</span> <span class="na">type=</span><span class="s">&quot;value&quot;</span><span class="nt">&gt;</span>1440368475<span class="nt">&lt;/atom&gt;</span>      <span class="nt">&lt;/list&gt;</span>
    <span class="nt">&lt;/atom&gt;</span>
  <span class="nt">&lt;/atom&gt;</span>
<span class="nt">&lt;/code&gt;</span>
</pre></div>
</td></tr></table></div>
<p>The above data is meaningless to the rest of the modo application and is specifically for use with this particular plugin.
The root element of this xml fragment is the &lt;atom type=”sy_p3d”&gt;&lt;/atom&gt;. The ‘service’ acquires this element for you when you first call the .ConfigureVis method and this should only be done &lt;b&gt;once&lt;/b&gt;. That is you should only have 1 CLxUser_PersistenceService instance attached to this root element at any one time.</p>
</div>
<div class="section" id="example-code">
<h2><a class="toc-backref" href="#id9">Example Code</a><a class="headerlink" href="#example-code" title="Permalink to this headline">¶</a></h2>
<div class="highlight-cpp notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="nc">CP3D_PersistentData</span> <span class="p">{</span>
  <span class="c1">//LoDs</span>
  <span class="n">CLxUser_PersistentEntry</span>   <span class="n">lods</span><span class="p">;</span>            <span class="c1">//atom</span>
  <span class="n">CLxUser_PersistentEntry</span>     <span class="n">lod</span><span class="p">;</span>           <span class="c1">//list</span>
  <span class="n">CLxUser_PersistentEntry</span>       <span class="n">lod_name</span><span class="p">;</span>    <span class="c1">//atom</span>
  <span class="n">CLxUser_PersistentEntry</span>       <span class="n">lod_value</span><span class="p">;</span>   <span class="c1">//atom</span>

  <span class="n">CLxUser_Attributes</span>        <span class="n">lod_name_attribute</span><span class="p">;</span>
  <span class="n">CLxUser_Attributes</span>        <span class="n">lod_value_attribute</span><span class="p">;</span>
<span class="p">}</span> <span class="o">*</span><span class="n">pP3D_Persist_Data</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>


<span class="k">class</span> <span class="nc">CP3D_PersistentVisitor</span> <span class="o">:</span> <span class="k">public</span> <span class="n">CLxImpl_AbstractVisitor</span> <span class="p">{</span>
  <span class="k">public</span><span class="o">:</span>
    <span class="c1">//virtual   ~CP3D_PersistentVisitor() {};</span>
    <span class="n">LxResult</span> <span class="n">Evaluate</span><span class="p">()</span> <span class="p">{</span>
      <span class="cm">/*</span>
<span class="cm">        Define accessors that encapsulate the varying elements</span>
<span class="cm">        of the persistent cfg data specifically relating to &#39;P3D&#39; data.</span>

<span class="cm">        Note: The &#39;sy_p3d&#39; root &#39;atom&#39; element is already defined prior</span>
<span class="cm">            to this when the service is instantiated.</span>
<span class="cm">            So, this &#39;setup&#39; evaluation method is defining the sub-elements.</span>
<span class="cm">      */</span>

      <span class="n">CLxUser_PersistenceService</span> <span class="n">svc</span><span class="p">;</span>

      <span class="n">svc</span><span class="p">.</span><span class="n">Start</span><span class="p">(</span><span class="s">&quot;lods&quot;</span><span class="p">,</span> <span class="n">LXi_PERSIST_ATOM</span><span class="p">);</span>


        <span class="n">svc</span><span class="p">.</span><span class="n">Start</span><span class="p">(</span><span class="s">&quot;lod&quot;</span><span class="p">,</span> <span class="n">LXi_PERSIST_LIST</span><span class="p">);</span>


          <span class="n">svc</span><span class="p">.</span><span class="n">Start</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="n">LXi_PERSIST_ATOM</span><span class="p">);</span>
            <span class="n">svc</span><span class="p">.</span><span class="n">AddValue</span><span class="p">(</span><span class="n">LXsTYPE_STRING</span><span class="p">);</span>
          <span class="n">svc</span><span class="p">.</span><span class="n">EndDef</span><span class="p">(</span><span class="n">pP3D_Persist_Data</span><span class="o">-&gt;</span><span class="n">lod_name</span><span class="p">);</span>


          <span class="n">svc</span><span class="p">.</span><span class="n">Start</span><span class="p">(</span><span class="s">&quot;value&quot;</span><span class="p">,</span> <span class="n">LXi_PERSIST_ATOM</span><span class="p">);</span>
            <span class="n">svc</span><span class="p">.</span><span class="n">AddValue</span><span class="p">(</span><span class="n">LXsTYPE_INTEGER</span><span class="p">);</span>
          <span class="n">svc</span><span class="p">.</span><span class="n">EndDef</span><span class="p">(</span><span class="n">pP3D_Persist_Data</span><span class="o">-&gt;</span><span class="n">lod_value</span><span class="p">);</span>


        <span class="n">svc</span><span class="p">.</span><span class="n">EndDef</span><span class="p">(</span><span class="n">pP3D_Persist_Data</span><span class="o">-&gt;</span><span class="n">lod</span><span class="p">);</span>


      <span class="n">svc</span><span class="p">.</span><span class="n">EndDef</span><span class="p">(</span><span class="n">pP3D_Persist_Data</span><span class="o">-&gt;</span><span class="n">lods</span><span class="p">);</span>


      <span class="n">pP3D_Persist_Data</span><span class="o">-&gt;</span><span class="n">lod_name_attribute</span><span class="p">.</span><span class="n">set</span>   <span class="p">(</span><span class="n">pP3D_Persist_Data</span><span class="o">-&gt;</span><span class="n">lod_name</span><span class="p">);</span>
      <span class="n">pP3D_Persist_Data</span><span class="o">-&gt;</span><span class="n">lod_value_attribute</span><span class="p">.</span><span class="n">set</span>  <span class="p">(</span><span class="n">pP3D_Persist_Data</span><span class="o">-&gt;</span><span class="n">lod_value</span><span class="p">);</span>
    <span class="p">};</span>
<span class="p">};</span>


<span class="n">CLxUser_Log</span> <span class="n">P3D_Persistence_Log</span><span class="p">;</span>


<span class="kt">void</span> <span class="nf">ReadPersistent_LoD_Data</span><span class="p">()</span> <span class="p">{</span>
  <span class="cm">/*</span>
<span class="cm">    This method is for caching the persistent data into 2 globally accessible std::map&#39;s.</span>
<span class="cm">  */</span>
  <span class="n">string</span> <span class="n">sName</span><span class="p">,</span> <span class="n">sLowercaseName</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">iValue</span><span class="p">;</span>
  <span class="kt">char</span> <span class="n">szName</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span>

  <span class="kt">int</span> <span class="n">NoOf_LoD_Entries</span> <span class="o">=</span> <span class="n">pP3D_Persist_Data</span><span class="o">-&gt;</span><span class="n">lod</span><span class="p">.</span><span class="n">Number</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">NoOf_LoD_Entries</span> <span class="o">!=</span> <span class="mi">-1</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i0</span> <span class="o">&lt;</span> <span class="n">NoOf_LoD_Entries</span><span class="p">;</span> <span class="n">i0</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">ZeroMemory</span><span class="p">(</span><span class="n">szName</span><span class="p">,</span> <span class="mi">256</span><span class="p">);</span>
      <span class="n">sName</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
      <span class="n">sLowercaseName</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
      <span class="n">iValue</span> <span class="o">=</span> <span class="mi">-1</span><span class="p">;</span>

      <span class="n">pP3D_Persist_Data</span><span class="o">-&gt;</span><span class="n">lod</span><span class="p">.</span><span class="n">Select</span><span class="p">(</span><span class="n">i0</span><span class="p">);</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">pP3D_Persist_Data</span><span class="o">-&gt;</span><span class="n">lod_name_attribute</span><span class="p">.</span><span class="n">GetString</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">szName</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span> <span class="o">==</span> <span class="n">LXe_OK</span><span class="p">)</span> <span class="c1">//Hopefully the element value string will never be longer than 256 chars.</span>
        <span class="n">sName</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">szName</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">((</span><span class="n">pP3D_Persist_Data</span><span class="o">-&gt;</span><span class="n">lod_value_attribute</span><span class="p">.</span><span class="n">GetInt</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">iValue</span><span class="p">)</span> <span class="o">==</span> <span class="n">LXe_OK</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">sName</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span>
      <span class="p">{</span>
        <span class="n">sLowercaseName</span> <span class="o">=</span> <span class="n">ToLower</span><span class="p">(</span><span class="n">sName</span><span class="p">);</span>

        <span class="c1">//This std::map is used during saving to find the integer value to write to the .p3d file based on the &#39;name&#39; of the mesh for those</span>
        <span class="c1">//special lod names in .p3d files.</span>
        <span class="n">LoDName2ValueMap</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">string</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">sLowercaseName</span><span class="p">,</span> <span class="n">iValue</span><span class="p">));</span>

        <span class="c1">//This std::map is used when loading a .p3d to find the special lod names to name the mesh item in modo.</span>
        <span class="n">LoDValue2NameMap</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="n">string</span><span class="o">&gt;</span><span class="p">(</span><span class="n">iValue</span><span class="p">,</span> <span class="n">sName</span><span class="p">));</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="n">P3D_Persistence_Log</span><span class="p">.</span><span class="n">Message</span><span class="p">(</span><span class="n">LXe_NOTAVAILABLE</span><span class="p">,</span> <span class="s">&quot;Config file &#39;lods&#39; data unavailable.&quot;</span><span class="p">);</span>
    <span class="n">pP3D_Persist_Data</span><span class="o">-&gt;</span><span class="n">lods_data</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>


<span class="kt">void</span> <span class="nf">P3DPersistence_Setup</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">pP3D_Persist_Data</span><span class="p">)</span>
    <span class="k">return</span><span class="p">;</span>

  <span class="n">pP3D_Persist_Data</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CP3D_PersistentData</span><span class="p">;</span>

  <span class="n">CLxUser_PersistenceService</span>      <span class="n">PersistenceService</span><span class="p">;</span>
  <span class="n">CP3D_PersistentVisitor</span>          <span class="n">P3DCfgVisitor</span><span class="p">;</span>

  <span class="n">P3D_Persistence_Log</span><span class="p">.</span><span class="n">setByName</span><span class="p">(</span><span class="s">&quot;sy/p3d/io&quot;</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">PersistenceService</span><span class="p">.</span><span class="n">ConfigureVis</span><span class="p">(</span><span class="s">&quot;sy_p3d&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">P3DCfgVisitor</span><span class="p">)</span> <span class="o">==</span> <span class="n">LXe_OK</span><span class="p">)</span>
    <span class="n">ReadPersistent_LoD_Data</span><span class="p">();</span>
  <span class="k">else</span>
    <span class="n">P3D_Persistence_Log</span><span class="p">.</span><span class="n">Message</span><span class="p">(</span><span class="n">LXe_NOTAVAILABLE</span><span class="p">,</span> <span class="s">&quot;Config file &#39;sy_p3d&#39; data unavailable.&quot;</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="p3dpersistence-setup">
<h3><a class="toc-backref" href="#id10">P3DPersistence_Setup</a><a class="headerlink" href="#p3dpersistence-setup" title="Permalink to this headline">¶</a></h3>
<p>The ‘P3DPersistence_Setup’ method is in the global scope. It calls into the CLxUser_PersistenceService. NOTE: It’s by no means gauranteed that ‘services’ within the modo runtime are up and running when you want to access them. In this particular case if you make a call into the CLxUser_PersistenceService during the plugin modules initialize() method the service is unavailable and consequently cannot grab the root element.
It’s best to defer access to the persistence service till at least the constructor for your plugin’s main class.</p>
<p><a href="#id1"><span class="problematic" id="id2">*</span></a>If the pointer pP3D_Persist_Data already exists then this setup method exits immediately. This is to satisfy the requirement that only ONE instantiation of the root element &lt;atom type=”sy_p3d”&gt; will be active at any one time else a new pointer is created.</p>
<p><a href="#id3"><span class="problematic" id="id4">*</span></a>Next we grab a log object into P3D_Persistence_Log for the specified log sub-system.</p>
<p><a href="#id5"><span class="problematic" id="id6">*</span></a>Then we make a call to the service to configure the accessors in the struct. If successful then we call a method to read the persistent values and cache them in std:map containers.</p>
<p>The Evaluate method of the visitor is responsible for defining the accessor CLxUser_PersistentEntry &amp; CLxUser_Attributes objects.</p>
<p>Essentially it starts and ends a definition for each element. Upon ending a element definition it instantiates a CLxUser_PersistentEntry.</p>
<p>If the particular element actually has a value, as is the case in the above example xml for the &lt;atom&gt; elements ‘name’ &amp; ‘value’ then during the definition you must define the ‘type’ of this value.</p>
<p>Finally, later when you want to actually get access to these values you cannot do so through just the CLxUser_PersistentEntry alone because the values are attributes. So, you need to setup an accessor CLxUser_Attributes object for the given CLxUser_PersistentEntry as well.</p>
<p>NOTE:
:Once the Evaluate method has finished successfully you are left with ‘accessor’ objects to the various xml elements that make up your plugins specific xml data.
:You can either have helper methods that access these accessor objects on an as needed basis like the helper classes for User Values and Peference Values OR (as is the case in this example) you can read all the data you need immediately and cache it in your plugin as you like.</p>
</div>
<div class="section" id="readpersistent-lod-data">
<h3><a class="toc-backref" href="#id11">ReadPersistent_LoD_Data</a><a class="headerlink" href="#readpersistent-lod-data" title="Permalink to this headline">¶</a></h3>
<p>In this particular example I’ve cached the xml data by reading from the xml file via the accessor objects and storing these values in globally accessoble std:map containers. The code should be fairly self-explanatory.</p>
</div>
</div>
<div class="section" id="additional-info">
<h2><a class="toc-backref" href="#id12">Additional Info</a><a class="headerlink" href="#additional-info" title="Permalink to this headline">¶</a></h2>
<p>…ToDo…</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Reading%20UV%20Values.html" class="btn btn-neutral float-right" title="Reading UV Values in Python" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Reading%20Files%20with%20Python.html" class="btn btn-neutral float-left" title="Reading Files with Python" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Foundry

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org/">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>

<!-- Mirrored from learn.foundry.com/modo/developers/latest/sdk/pages/tutorials/Reading Persistant Data.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 30 Nov 2024 03:16:09 GMT -->
</html>