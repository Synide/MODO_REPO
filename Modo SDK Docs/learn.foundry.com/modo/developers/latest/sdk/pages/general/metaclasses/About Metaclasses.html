

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->

<!-- Mirrored from learn.foundry.com/modo/developers/latest/sdk/pages/general/metaclasses/About Metaclasses.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 30 Nov 2024 03:15:53 GMT -->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>About Metaclasses &mdash; Modo SDK 14.2v0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
        <script src="../../../_static/js/contentui.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Channel Modifier (metaclass)" href="Channel%20Modifier%20(metaclass).html" />
    <link rel="prev" title="Visitors in Action" href="../serverinfo/Visitors%20in%20Action.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> Modo SDK
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="https://learn.foundry.com/modo/developers/latest/sdk/search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Articles</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../starting/_starting.html">First Steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../server_basics/_server_basics.html">Server Basics</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../_general.html">Editorial Info</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../_general.html#general-info">General Info</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_general.html#underlying-systems">Underlying Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_general.html#interface-details">Interface Details</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../_general.html#metaclasses">MetaClasses</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">About Metaclasses</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#base-class">Base Class</a></li>
<li class="toctree-l4"><a class="reference internal" href="#template-class">Template Class</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example-usage">Example Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tree-searches">Tree Searches</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Channel%20Modifier%20(metaclass).html">Channel Modifier (metaclass)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Channels%20(metaclass).html">Channels (metaclass)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Eval%20Modifier%20(metaclass).html">Eval Modifier (metaclass)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Schematic%20Connection%20(metaclass).html">Schematic Connection (metaclass)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Value%20Texture%20(metaclass).html">Value Texture (metaclass)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../_general.html#additional-resources">Additional Resources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../ui/_ui.html">User Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scripting/_scripting.html">Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faqs/_faqs.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption"><span class="caption-text">Code Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/_tutorials.html">SDK Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/_examples.html">Code Examples and Snippets</a></li>
</ul>
<p class="caption"><span class="caption-text">Technical Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../python/python.html">Python Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cpp/cpp.html">C++ Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Modo SDK</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../_general.html">Editorial Info</a> &raquo;</li>
        
      <li>About Metaclasses</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="about-metaclasses">
<h1>About Metaclasses<a class="headerlink" href="#about-metaclasses" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#base-class" id="id1">Base Class</a></p></li>
<li><p><a class="reference internal" href="#template-class" id="id2">Template Class</a></p></li>
<li><p><a class="reference internal" href="#example-usage" id="id3">Example Usage</a></p></li>
<li><p><a class="reference internal" href="#tree-searches" id="id4">Tree Searches</a></p></li>
</ul>
</div>
<p>The MODO 10 SDK has introduced the concept of ‘’metaclasses’’. A Metaclass  is an object that serves as the factory for a whole set of related objects of the same type. For those familiar with the SDK a Polymorph or Spawner is a type of metaclass, but at a very low level. They require a lot of manual configuration to get useful SDK objects. The metaclasses in MODO 10 are specifically designed to make it easy to create plug-ins by automating a lot of the boilerplate that makes the SDK hard to use.</p>
<div class="section" id="base-class">
<h2><a class="toc-backref" href="#id1">Base Class</a><a class="headerlink" href="#base-class" title="Permalink to this headline">¶</a></h2>
<p>Metaclasses are composed of a base class and a template class. They are specific to the type of server or object being created, and the names of the classes derive from the interface for that object type. For example to create a Package server (ILxPackage interface) we’d use the <em>CLxPackage</em> base class and the <em>CLxMeta_Package</em> template class. For this example let’s imagine a hypothetical server type <em>Foo</em> which manages a list of strings. The first part of the metaclass would be the <em>CLxFoo</em> base class:</p>
<div class="highlight-cpp notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cm">/*</span>
<span class="cm"> * Base class for Foo metaclass. (NOTE: not a real server type!)</span>
<span class="cm"> */</span>
<span class="k">class</span> <span class="nc">CLxFoo</span>
<span class="p">{</span>
    <span class="k">public</span><span class="o">:</span>
        <span class="cm">/*</span>
<span class="cm">         * Override method to refresh the string list. Add strings one by one using add_entry().</span>
<span class="cm">         */</span>
        <span class="k">virtual</span> <span class="kt">void</span>              <span class="n">get_list</span> <span class="p">()</span> <span class="p">{</span> <span class="p">}</span>
        <span class="kt">void</span>                      <span class="n">add_entry</span> <span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">);</span>

        <span class="k">class</span> <span class="nc">pv_Foo</span> <span class="o">*</span><span class="n">pv</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</td></tr></table></div>
<p>This is a pure C++ class that contains virtual and non-virtual methods. The virtual methods can be overridden by sub-classes implemented by the plug-in developer. Those methods implement the core functionality of their plug-in. The non-virtual methods are helpers that maintain the state of the object and allow it to implement the COM methods of the interface. In this case the developer would write their own get_list() method to populate the list by calling add_entry() for each one. The metaclass would then implement whatever methods were expected for COM using that cached list. The ‘pv’ pointer contains the state of the base class and is effectively private.</p>
</div>
<div class="section" id="template-class">
<h2><a class="toc-backref" href="#id2">Template Class</a><a class="headerlink" href="#template-class" title="Permalink to this headline">¶</a></h2>
<p>The second part of the metaclass is the template. This takes the developer’s subclass and defines a CLxMeta object using that. In reality this is split into two classes – the core and the template – but the core is there just to serve as a concrete class for the template to derive from. In practice the meta object is logically one type.</p>
<div class="highlight-cpp notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cm">/*</span>
<span class="cm"> * Core class for Foo metaclass template. (NOTE: not a real server type!)</span>
<span class="cm"> */</span>
<span class="k">class</span> <span class="nc">CLxMeta_Foo_Core</span> <span class="o">:</span>
                <span class="k">public</span> <span class="n">CLxMeta</span>
<span class="p">{</span>
    <span class="k">public</span><span class="o">:</span>
         <span class="n">CLxMeta_Foo_Core</span> <span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">srvName</span><span class="p">);</span>
        <span class="o">~</span><span class="n">CLxMeta_Foo_Core</span> <span class="p">();</span>
        <span class="k">class</span> <span class="nc">pv_Meta_Foo</span>       <span class="o">*</span><span class="n">pv</span><span class="p">;</span>
        <span class="k">virtual</span> <span class="n">CLxFoo</span> <span class="o">*</span>         <span class="n">new_inst</span> <span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="kt">void</span> <span class="o">*</span>                   <span class="nf">alloc</span> <span class="p">()</span> <span class="n">LXx_OVERRIDE</span><span class="p">;</span>

        <span class="cm">/*</span>
<span class="cm">         * Add a server tag.</span>
<span class="cm">         */</span>
        <span class="kt">void</span>            <span class="nf">add_tag</span> <span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">tag</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">val</span><span class="p">);</span>

        <span class="cm">/*</span>
<span class="cm">         * By default the list is static. It can be made dynamic in which case it needs</span>
<span class="cm">         * to be invalidated when it changes.</span>
<span class="cm">         */</span>
        <span class="kt">void</span>            <span class="nf">set_dynamic</span> <span class="p">();</span>
        <span class="kt">void</span>            <span class="nf">invalidate</span> <span class="p">();</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Template class for Foo metaclass. (NOTE: not a real server type!)</span>
<span class="cm"> */</span>
<span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="o">&gt;</span>
<span class="k">class</span> <span class="nc">CLxMeta_Foo</span><span class="o">:</span>
                <span class="k">public</span> <span class="n">CLxMeta_Foo_Core</span>
<span class="p">{</span>
    <span class="k">public</span><span class="o">:</span>
        <span class="n">CLxMeta_Foo</span> <span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">srvName</span><span class="p">)</span> <span class="o">:</span> <span class="n">CLxMeta_Foo_Core</span> <span class="p">(</span><span class="n">srvName</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>

                <span class="n">CLxFoo</span> <span class="o">*</span>
        <span class="n">new_inst</span> <span class="p">()</span>
        <span class="p">{</span>
                <span class="k">return</span> <span class="k">new</span> <span class="n">T</span><span class="p">;</span>
        <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</td></tr></table></div>
<p>It looks like there’s a lot to this, but there isn’t. The only thing that the developer needs to worry about is the template class, and the commented methods it inherits from the core class. Those methods – ‘’add_tag()’’, ‘’set_dynamic()’’, and <em>invalidate()</em> in this case – are used to configure the common attributes of all the objects generated by this metaclass. For example since this is a server <em>add_tag()</em> adds server tags such as user name or licensing info to the server object.</p>
</div>
<div class="section" id="example-usage">
<h2><a class="toc-backref" href="#id3">Example Usage</a><a class="headerlink" href="#example-usage" title="Permalink to this headline">¶</a></h2>
<p>The point of all this is to hide the complexity of implementing servers and other SDK objects from the plug-in developer, and to make their code simpler and easier to maintain. As an example, here’s a a simple Foo server that just makes a list of three items. (There is no such server type as Foo – this is a contrived and too-simple example.)</p>
<div class="highlight-cpp notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyFoo</span> <span class="o">:</span> <span class="k">public</span> <span class="n">CLxFoo</span>
<span class="p">{</span>
    <span class="k">public</span><span class="o">:</span>
        <span class="kt">void</span>              <span class="n">get_list</span> <span class="p">()</span>       <span class="n">LXx_OVERRIDE</span>
        <span class="p">{</span>
                <span class="n">add_entry</span> <span class="p">(</span><span class="s">&quot;One&quot;</span><span class="p">);</span>
                <span class="n">add_entry</span> <span class="p">(</span><span class="s">&quot;Two&quot;</span><span class="p">);</span>
                <span class="n">add_entry</span> <span class="p">(</span><span class="s">&quot;Three&quot;</span><span class="p">);</span>
        <span class="p">}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="n">CLxMeta_Foo</span><span class="o">&lt;</span><span class="n">MyFoo</span><span class="o">&gt;</span>  <span class="n">foo_meta</span> <span class="p">(</span><span class="s">&quot;myFooServerName&quot;</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p>The static <em>foo_meta</em> object represents a Foo server with the name “myFooServerName” specialized with the client’s <em>MyFoo</em> subclass. The final step is initialization, which requires adding this metaclass as a child of a root. This will typically be done in the plug-in <em>initialize()</em> method.</p>
<div class="highlight-cpp notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">static</span> <span class="n">CLxMetaRoot</span>  <span class="n">root_meta</span><span class="p">;</span>

        <span class="kt">void</span>
<span class="nf">initialize</span> <span class="p">()</span>
<span class="p">{</span>
        <span class="n">foo_meta</span><span class="p">.</span><span class="n">add_tag</span> <span class="p">(</span><span class="n">LXsSRV_USERNAME</span><span class="p">,</span> <span class="s">&quot;Foo Example&quot;</span><span class="p">);</span>

        <span class="n">root_meta</span><span class="p">.</span><span class="n">add</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">foo_meta</span><span class="p">);</span>
        <span class="n">root_meta</span><span class="p">.</span><span class="n">initialize</span> <span class="p">();</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>CLxMeta objects are linked into trees, with the shared <em>add()</em> method used to string nodes together. Here the Foo metaclass is made a child of root, and then the root is initialized to install any servers or other objects it contains. The <em>initialize()</em> function is also used to set any state on the metaclasses, such as adding the username tag to the Foo server.</p>
</div>
<div class="section" id="tree-searches">
<h2><a class="toc-backref" href="#id4">Tree Searches</a><a class="headerlink" href="#tree-searches" title="Permalink to this headline">¶</a></h2>
<p>In more complex examples there may be multiple metaclasses that work together. For example a Package and a Modifier that both share the same Channel definition, or a Package that has extensions for optional interfaces. In these cases each metaclass will search the tree that it’s part of in order to find related metaclasses. The search starts by going down, looking for metaclasses that are its children in the tree. If a suitable metaclass isn’t found there it will then start to look higher in the tree. By placing related objects close in the tree the developer can control the results of the search. Regular CLxMeta objects can also be created and used for grouping.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Channel%20Modifier%20(metaclass).html" class="btn btn-neutral float-right" title="Channel Modifier (metaclass)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../serverinfo/Visitors%20in%20Action.html" class="btn btn-neutral float-left" title="Visitors in Action" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Foundry

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org/">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>

<!-- Mirrored from learn.foundry.com/modo/developers/latest/sdk/pages/general/metaclasses/About Metaclasses.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 30 Nov 2024 03:15:53 GMT -->
</html>