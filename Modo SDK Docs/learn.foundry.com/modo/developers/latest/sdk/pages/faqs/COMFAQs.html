

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->

<!-- Mirrored from learn.foundry.com/modo/developers/latest/sdk/pages/faqs/COMFAQs.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 30 Nov 2024 03:16:00 GMT -->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>About COM &mdash; Modo SDK 14.2v0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/js/contentui.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Channels" href="ChannelFAQs.html" />
    <link rel="prev" title="Frequently Asked Questions" href="_faqs.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Modo SDK
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="https://learn.foundry.com/modo/developers/latest/sdk/search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Articles</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../starting/_starting.html">First Steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server_basics/_server_basics.html">Server Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/_general.html">Editorial Info</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ui/_ui.html">User Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripting/_scripting.html">Scripting</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="_faqs.html">Frequently Asked Questions</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">About COM</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#how-do-i-get-a-service-object">How do I get a service object?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-do-i-get-my-c-implementation-from-a-com-handle">How do I get my C++ implementation from a COM handle?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#is-it-possible-to-create-com-wrappers-for-other-languages">Is it possible to create COM wrappers for other languages?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ChannelFAQs.html">Channels</a></li>
<li class="toctree-l2"><a class="reference internal" href="CppFAQs.html">C++ Specific</a></li>
<li class="toctree-l2"><a class="reference internal" href="GeneralFAQ.html">General</a></li>
<li class="toctree-l2"><a class="reference internal" href="ItemFAQs.html">Items</a></li>
<li class="toctree-l2"><a class="reference internal" href="MeshFAQ.html">Meshes</a></li>
<li class="toctree-l2"><a class="reference internal" href="ModifierFAQ.html">Modifiers</a></li>
<li class="toctree-l2"><a class="reference internal" href="PythonFAQs.html">Python Specific</a></li>
<li class="toctree-l2"><a class="reference internal" href="SelectionFAQ.html">General</a></li>
<li class="toctree-l2"><a class="reference internal" href="TimeFAQs.html">Dealing with Time</a></li>
<li class="toctree-l2"><a class="reference internal" href="UIFAQ.html">User Interface</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Code Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/_tutorials.html">SDK Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/_examples.html">Code Examples and Snippets</a></li>
</ul>
<p class="caption"><span class="caption-text">Technical Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../python/python.html">Python Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cpp/cpp.html">C++ Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Modo SDK</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="_faqs.html">Frequently Asked Questions</a> &raquo;</li>
        
      <li>About COM</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="about-com">
<h1>About COM<a class="headerlink" href="#about-com" title="Permalink to this headline">¶</a></h1>
<div class="section" id="how-do-i-get-a-service-object">
<h2>How do I get a service object?<a class="headerlink" href="#how-do-i-get-a-service-object" title="Permalink to this headline">¶</a></h2>
<p>Services are global objects, so unlike traditional localized COM objects, they don’t need to be initialized. You can simply declare them and then start using them.</p>
<div class="content-tabs docutils container">
<div class="tab-content docutils container" id="tab-cpp">
<p class="tab-title">C++</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">CLxUser_SceneService</span>      <span class="n">scn_svc</span><span class="p">;</span>
<span class="n">LXtItemType</span>               <span class="n">mesh_type</span><span class="p">;</span>

<span class="n">scn_svc</span><span class="p">.</span><span class="n">ItemTypeLookup</span> <span class="p">(</span><span class="n">LXsITYPE_MESH</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">mesh_type</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="tab-content docutils container" id="tab-py">
<p class="tab-title">Python</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">scn_svc</span> <span class="o">=</span> <span class="n">lx</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">Scene</span><span class="p">()</span>

<span class="n">mesh_type</span> <span class="o">=</span> <span class="n">scn_svc</span><span class="o">.</span><span class="n">ItemTypeLookup</span> <span class="p">(</span><span class="n">lx</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">sITYPE_MESH</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The constructor for the C++ wrapper calls lx::GetGlobal() to initialize the interface. In some instances, such as when a service is created too early, the GetGlobal function call will fail. In these cases, it may be necessary to initialize the service wrapper manually. If you declare your service object as a static variable, and then simply call set() before use to initialize the interface.</p>
<div class="content-tabs docutils container">
<div class="tab-content docutils container" id="tab-cpp">
<p class="tab-title">C++</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">static</span> <span class="n">CLxUser_SceneService</span>      <span class="n">scn_svc</span><span class="p">;</span>

<span class="n">scn_svc</span><span class="p">.</span><span class="n">set</span> <span class="p">();</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="how-do-i-get-my-c-implementation-from-a-com-handle">
<h2>How do I get my C++ implementation from a COM handle?<a class="headerlink" href="#how-do-i-get-my-c-implementation-from-a-com-handle" title="Permalink to this headline">¶</a></h2>
<p>If you have an interface handle and you know the type of the C++ object that’s implementing it, you can unwrap the COM object and get at the meaty C++ object inside. If this is one of your servers, then you just have to call lx::CastServer() with the server name:</p>
<div class="content-tabs docutils container">
<div class="tab-content docutils container" id="tab-cpp">
<p class="tab-title">C++</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span>        <span class="n">CMyClass</span> <span class="o">*</span>
<span class="nf">Extract</span> <span class="p">(</span>
        <span class="n">ILxUnknownID</span>             <span class="n">from</span><span class="p">)</span>
<span class="p">{</span>
        <span class="n">CMyClass</span>                <span class="o">*</span><span class="n">mine</span><span class="p">;</span>

        <span class="n">lx</span><span class="o">::</span><span class="n">CastServer</span> <span class="p">(</span><span class="n">SERVER_NAME</span><span class="p">,</span> <span class="n">from</span><span class="p">,</span> <span class="n">mine</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">mine</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>If the COM object comes from a spawner then you need to use the Cast() method on the spawner:</p>
<div class="content-tabs docutils container">
<div class="tab-content docutils container" id="tab-cpp">
<p class="tab-title">C++</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span>        <span class="n">CMyClass</span> <span class="o">*</span>
<span class="nf">Extract</span> <span class="p">(</span>
        <span class="n">ILxUnknownID</span>             <span class="n">from</span><span class="p">)</span>
<span class="p">{</span>
        <span class="n">CLxSpawner</span><span class="o">&lt;</span><span class="n">CMyClass</span><span class="o">&gt;</span>     <span class="n">spawn</span> <span class="p">(</span><span class="s">&quot;myClass&quot;</span><span class="p">);</span>

        <span class="k">return</span> <span class="n">spawn</span><span class="p">.</span><span class="n">Cast</span> <span class="p">(</span><span class="n">from</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>You have to make sure that the interface pointer you have is actually implemented by your class. If you get an ILxItemID pointer, for example, you need to query for one of your specific implemented interfaces in order to be able to get your package instance class.</p>
</div>
<div class="section" id="is-it-possible-to-create-com-wrappers-for-other-languages">
<h2>Is it possible to create COM wrappers for other languages?<a class="headerlink" href="#is-it-possible-to-create-com-wrappers-for-other-languages" title="Permalink to this headline">¶</a></h2>
<p>Yes. Yes it is.
:ref: <cite>Language Wrappers</cite></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ChannelFAQs.html" class="btn btn-neutral float-right" title="Channels" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="_faqs.html" class="btn btn-neutral float-left" title="Frequently Asked Questions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Foundry

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org/">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>

<!-- Mirrored from learn.foundry.com/modo/developers/latest/sdk/pages/faqs/COMFAQs.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 30 Nov 2024 03:16:00 GMT -->
</html>