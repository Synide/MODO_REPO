

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->

<!-- Mirrored from learn.foundry.com/modo/developers/latest/sdk/pages/faqs/PythonFAQs.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 30 Nov 2024 03:16:00 GMT -->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Python Specific &mdash; Modo SDK 14.2v0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/js/contentui.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="General" href="SelectionFAQ.html" />
    <link rel="prev" title="Modifiers" href="ModifierFAQ.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Modo SDK
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="https://learn.foundry.com/modo/developers/latest/sdk/search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Articles</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../starting/_starting.html">First Steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server_basics/_server_basics.html">Server Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/_general.html">Editorial Info</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ui/_ui.html">User Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripting/_scripting.html">Scripting</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="_faqs.html">Frequently Asked Questions</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="COMFAQs.html">About COM</a></li>
<li class="toctree-l2"><a class="reference internal" href="ChannelFAQs.html">Channels</a></li>
<li class="toctree-l2"><a class="reference internal" href="CppFAQs.html">C++ Specific</a></li>
<li class="toctree-l2"><a class="reference internal" href="GeneralFAQ.html">General</a></li>
<li class="toctree-l2"><a class="reference internal" href="ItemFAQs.html">Items</a></li>
<li class="toctree-l2"><a class="reference internal" href="MeshFAQ.html">Meshes</a></li>
<li class="toctree-l2"><a class="reference internal" href="ModifierFAQ.html">Modifiers</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Python Specific</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#why-does-dll-loading-fail-when-loading-an-external-python-package">Why does DLL loading fail when loading an external Python Package?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-do-i-remove-a-listener-object-in-python">How do I remove a listener object in Python?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="SelectionFAQ.html">General</a></li>
<li class="toctree-l2"><a class="reference internal" href="TimeFAQs.html">Dealing with Time</a></li>
<li class="toctree-l2"><a class="reference internal" href="UIFAQ.html">User Interface</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Code Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/_tutorials.html">SDK Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/_examples.html">Code Examples and Snippets</a></li>
</ul>
<p class="caption"><span class="caption-text">Technical Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../python/python.html">Python Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cpp/cpp.html">C++ Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Modo SDK</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="_faqs.html">Frequently Asked Questions</a> &raquo;</li>
        
      <li>Python Specific</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="python-specific">
<h1>Python Specific<a class="headerlink" href="#python-specific" title="Permalink to this headline">¶</a></h1>
<div class="section" id="why-does-dll-loading-fail-when-loading-an-external-python-package">
<h2>Why does DLL loading fail when loading an external Python Package?<a class="headerlink" href="#why-does-dll-loading-fail-when-loading-an-external-python-package" title="Permalink to this headline">¶</a></h2>
<p>Only Python DLL’s (or .pyd files) build with MS Visual Studio 2010 are compatible with Modo 801/901.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">ImportError</span><span class="p">:</span> <span class="n">DLL</span> <span class="n">load</span> <span class="n">failed</span><span class="p">:</span> <span class="o">%</span><span class="mi">1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">a</span> <span class="n">valid</span> <span class="n">Win32</span> <span class="n">application</span><span class="o">.</span>
</pre></div>
</div>
<p>Most often the source code can be found on GitHub to be compiled with MSVC 2010.</p>
</div>
<div class="section" id="how-do-i-remove-a-listener-object-in-python">
<h2>How do I remove a listener object in Python?<a class="headerlink" href="#how-do-i-remove-a-listener-object-in-python" title="Permalink to this headline">¶</a></h2>
<p>A listener is an object you export to be called when changes occur. You create the object and add it, and then remove it when you are done listening. This is a bit tricky in Python, however, because the automatic type conversion in the API works against you. For example, let’s say you do the obvious thing and try this:</p>
<div class="content-tabs docutils container">
<div class="tab-content docutils container" id="tab-py">
<p class="tab-title">Python</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyListener</span><span class="p">(</span><span class="n">lxifc</span><span class="o">.</span><span class="n">SceneItemListener</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="n">lSrv</span> <span class="o">=</span> <span class="n">lx</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">Listener</span><span class="p">()</span>
<span class="n">listener</span> <span class="o">=</span> <span class="n">MyListener</span><span class="p">()</span>

<span class="n">lSrv</span><span class="o">.</span><span class="n">AddListener</span><span class="p">(</span><span class="n">listener</span><span class="p">)</span>
<span class="n">lSrv</span><span class="o">.</span><span class="n">RemoveListener</span><span class="p">(</span><span class="n">listener</span><span class="p">)</span> <span class="c1"># This won&#39;t do what you expect.</span>
</pre></div>
</div>
</div>
</div>
<p>Your listener object will be added, but trying to remove it will result in a ‘not found’ exception. (In older versions of MODO this did not generate an error but left your listener object installed.) The problem is that passing a Python object to a method that expects a COM object will do the conversion automatically, but this means that the two functions are called with different COM objects. Because MODO doesn’t recognize the second object as being the same as the first, the listener remains installed.</p>
<p>The solution is to pre-allocate the COM version of your object. You can then pass this to both functions and it will be seen as the same object.</p>
<p>As part of modifier evaluation however, time is not universal. Modifiers can be evaluated at arbitrary times and should not rely on the time provided by the selection system. Instead, they should allocate time as an input to the modifier, allowing the evaluation time to be determined.</p>
<div class="content-tabs docutils container">
<div class="tab-content docutils container" id="tab-py">
<p class="tab-title">Python</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyListener</span><span class="p">(</span><span class="n">lxifc</span><span class="o">.</span><span class="n">SceneItemListener</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="n">lSrv</span> <span class="o">=</span> <span class="n">lx</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">Listener</span><span class="p">()</span>
<span class="n">listener</span> <span class="o">=</span> <span class="n">MyListener</span><span class="p">()</span>
<span class="n">com_listener</span> <span class="o">=</span> <span class="n">lx</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">Unknown</span><span class="p">(</span><span class="n">listener</span><span class="p">)</span>

<span class="n">lSrv</span><span class="o">.</span><span class="n">AddListener</span><span class="p">(</span><span class="n">com_listener</span><span class="p">)</span>
<span class="n">lSrv</span><span class="o">.</span><span class="n">RemoveListener</span><span class="p">(</span><span class="n">com_listener</span><span class="p">)</span> <span class="c1"># This will correctly remove the listener that was previously spawned.</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="SelectionFAQ.html" class="btn btn-neutral float-right" title="General" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ModifierFAQ.html" class="btn btn-neutral float-left" title="Modifiers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Foundry

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org/">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>

<!-- Mirrored from learn.foundry.com/modo/developers/latest/sdk/pages/faqs/PythonFAQs.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 30 Nov 2024 03:16:00 GMT -->
</html>