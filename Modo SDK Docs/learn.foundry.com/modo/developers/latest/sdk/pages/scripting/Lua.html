

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->

<!-- Mirrored from learn.foundry.com/modo/developers/latest/sdk/pages/scripting/Lua.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 30 Nov 2024 03:16:00 GMT -->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Lua &mdash; Modo SDK 14.2v0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/js/contentui.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Macros" href="Macros.html" />
    <link rel="prev" title="Layerservice" href="Layerservice.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Modo SDK
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="https://learn.foundry.com/modo/developers/latest/sdk/search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Articles</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../starting/_starting.html">First Steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server_basics/_server_basics.html">Server Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/_general.html">Editorial Info</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ui/_ui.html">User Interface</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="_scripting.html">Scripting</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="AppleScript.html">AppleScript</a></li>
<li class="toctree-l2"><a class="reference internal" href="Bouncing%20Ball%20Script%20(Transform%20Channels).html">Bouncing Ball Script (Transform Channels)</a></li>
<li class="toctree-l2"><a class="reference internal" href="ChangeRenderFrameRange%20Script.html">ChangeRenderFrameRange Script</a></li>
<li class="toctree-l2"><a class="reference internal" href="Layerservice.html">Layerservice</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Lua</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#modo-extensions-to-lua">modo Extensions to Lua</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#lx">lx()</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#arguments">Arguments</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exiting-with-error">Exiting with error</a></li>
<li class="toctree-l3"><a class="reference internal" href="#progress-monitors">Progress Monitors</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#lxmoninit">lxmonInit()</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#more-information">More Information</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Macros.html">Macros</a></li>
<li class="toctree-l2"><a class="reference internal" href="Perl.html">Perl</a></li>
<li class="toctree-l2"><a class="reference internal" href="Script%20lua.html">Script lua</a></li>
<li class="toctree-l2"><a class="reference internal" href="ScriptQuery%20Interface%20701%20Updates.html">ScriptQuery Interface 701 Updates</a></li>
<li class="toctree-l2"><a class="reference internal" href="ScriptQuery%20Overview.html">ScriptQuery Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="Scripting.html">Scripting</a></li>
<li class="toctree-l2"><a class="reference internal" href="Scripting%20Preview.html">Scripting Preview</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../faqs/_faqs.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption"><span class="caption-text">Code Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/_tutorials.html">SDK Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/_examples.html">Code Examples and Snippets</a></li>
</ul>
<p class="caption"><span class="caption-text">Technical Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../python/python.html">Python Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cpp/cpp.html">C++ Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Modo SDK</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="_scripting.html">Scripting</a> &raquo;</li>
        
      <li>Lua</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="lua">
<h1>Lua<a class="headerlink" href="#lua" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#modo-extensions-to-lua" id="id1">modo Extensions to Lua</a></p>
<ul>
<li><p><a class="reference internal" href="#lx" id="id2">lx()</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#arguments" id="id3">Arguments</a></p></li>
<li><p><a class="reference internal" href="#exiting-with-error" id="id4">Exiting with error</a></p></li>
<li><p><a class="reference internal" href="#progress-monitors" id="id5">Progress Monitors</a></p>
<ul>
<li><p><a class="reference internal" href="#lxmoninit" id="id6">lxmonInit()</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#more-information" id="id7">More Information</a></p></li>
</ul>
</div>
<p>Lua]] is a configuration language commonly used in game development. Lua scripts are executed in the same way as [[Perl]] and [[Python scripts within ‘’modo’’, and provide the same level of functionality.</p>
<p>As with <a class="reference internal" href="Macros.html"><span class="doc">Macros</span></a> to obtain lower-level information from the various subsystems, including extracting specific mesh information that is not otherwise accessible through commands themselves.</p>
<p>For the official Lua documentation, visit [<a class="reference external" href="http://www.lua.org/">http://www.lua.org</a> <a class="reference external" href="http://www.lua.org/">http://www.lua.org</a>] .</p>
<div class="section" id="modo-extensions-to-lua">
<h2><a class="toc-backref" href="#id1">modo Extensions to Lua</a><a class="headerlink" href="#modo-extensions-to-lua" title="Permalink to this headline">¶</a></h2>
<p>A number of new functions have been added to Lua in ‘’modo’’.  The most common batch include ‘’lx’’, ‘’lxq’’, ‘’lxqt’’, ‘’lxeval’’, ‘’lxok’’, ‘’lxres’’, <em>lxout</em> and ‘’lxtrace’’. Errors are reported to the <a class="reference internal" href="../ui/Event%20Log%20Viewport.html"><span class="doc">Event Log Viewport</span></a>, so it?s useful to have one open while developing Lua scripts.</p>
<div class="section" id="lx">
<h3><a class="toc-backref" href="#id2">lx()</a><a class="headerlink" href="#lx" title="Permalink to this headline">¶</a></h3>
<p>The <strong>lx</strong> function is used to execute commands using the standard <em>modo</em> Command System: Basics. This returns 1 if the command executed successfully, and <em>nil</em> if it failed for any reason. <em>lxres</em> can be used to get more specific information about why a command failed. Also be sure to check the Event Log viewport.</p>
<div class="highlight-lua notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="c1">-- lua</span>

<span class="n">ok</span> <span class="o">=</span> <span class="n">lx</span><span class="p">(</span> <span class="s2">&quot;tool.set prim.cube on&quot;</span> <span class="p">)</span>
 <span class="kr">if</span> <span class="ow">not</span> <span class="n">ok</span> <span class="kr">then</span>
     <span class="c1">-- handle errors here</span>
<span class="kr">end</span>
<span class="o">&lt;/</span><span class="n">syntaxhighlight</span> <span class="o">&gt;</span>

<span class="o">===</span> <span class="n">lxq</span><span class="p">()</span> <span class="o">===</span>

<span class="n">The</span> <span class="s1">&#39;&#39;&#39;lxq&#39;&#39;&#39;</span> <span class="kr">function</span> <span class="nf">queries</span> <span class="n">a</span> <span class="n">command</span> <span class="n">using</span> <span class="n">the</span> <span class="n">standard</span> <span class="n">question</span> <span class="n">mark</span> <span class="n">syntax</span><span class="p">,</span> <span class="n">returning</span> <span class="n">a</span> <span class="n">table</span> <span class="n">of</span> <span class="n">values</span><span class="p">.</span> <span class="n">Note</span> <span class="n">that</span> <span class="n">this</span> <span class="n">always</span> <span class="n">returns</span> <span class="n">a</span> <span class="n">table</span><span class="p">,</span> <span class="n">even</span> <span class="kr">if</span> <span class="n">there</span> <span class="n">is</span> <span class="n">only</span> <span class="n">one</span> <span class="n">value</span> <span class="kr">in</span> <span class="n">the</span> <span class="n">table</span><span class="p">.</span>  <span class="n">Table</span> <span class="n">keys</span> <span class="n">are</span> <span class="n">simple</span> <span class="n">indices</span> <span class="n">starting</span> <span class="n">from</span> <span class="mf">1.</span>  <span class="s1">&#39;&#39;</span><span class="n">table</span><span class="p">.</span><span class="n">foreach</span><span class="s1">&#39;&#39;</span> <span class="n">can</span> <span class="n">be</span> <span class="n">used</span> <span class="n">to</span> <span class="n">walk</span> <span class="n">the</span> <span class="n">array</span><span class="p">,</span> <span class="ow">or</span> <span class="n">a</span> <span class="n">simple</span> <span class="kr">for</span> <span class="n">loop</span> <span class="n">can</span> <span class="n">be</span> <span class="n">used</span><span class="p">.</span> <span class="n">If</span> <span class="n">there</span> <span class="n">was</span> <span class="n">an</span> <span class="nb">error</span> <span class="n">querying</span> <span class="n">the</span> <span class="n">command</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="kc">nil</span><span class="s1">&#39;&#39;</span> <span class="n">is</span> <span class="n">returned</span><span class="p">.</span>

<span class="n">Via</span> <span class="n">table</span><span class="p">.</span><span class="n">foreach</span><span class="p">:</span>

<span class="o">&lt;</span><span class="n">syntaxhighlight</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;lua&quot;</span><span class="o">&gt;</span>
 <span class="c1">-- lua</span>

 <span class="kr">function</span> <span class="nf">ProcessSelMaterialNames</span><span class="p">(</span> <span class="n">index</span><span class="p">,</span> <span class="n">name</span> <span class="p">)</span>
     <span class="c1">-- Process material names here</span>
 <span class="kr">end</span>

 <span class="c1">-- Get an array of names, one for each selected material</span>
 <span class="n">selMaterialNames</span> <span class="o">=</span> <span class="n">lxq</span><span class="p">(</span> <span class="s2">&quot;material.name ?&quot;</span> <span class="p">)</span>
 <span class="n">table</span><span class="p">.</span><span class="n">foreach</span><span class="p">(</span> <span class="n">selMaterialNames</span><span class="p">,</span> <span class="n">ProcessSelMaterialNames</span> <span class="p">)</span>

 <span class="c1">-- Just look at the first value in the array.</span>
 <span class="n">firstValue</span> <span class="o">=</span> <span class="n">selMaterialNames</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="o">&lt;/</span><span class="n">syntaxhighlight</span> <span class="o">&gt;</span>

<span class="n">via</span> <span class="n">a</span> <span class="n">form</span> <span class="n">loop</span><span class="p">:</span>

<span class="o">&lt;</span><span class="n">syntaxhighlight</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;lua&quot;</span><span class="o">&gt;</span>
 <span class="c1">-- lua</span>

 <span class="c1">-- Get an array of names, one for each selected material</span>
 <span class="n">selMaterialNames</span> <span class="o">=</span> <span class="n">lxq</span><span class="p">(</span> <span class="s2">&quot;material.name ?&quot;</span> <span class="p">)</span>
 <span class="n">table</span><span class="p">.</span><span class="n">foreach</span><span class="p">(</span> <span class="n">selMaterialNames</span><span class="p">,</span> <span class="n">ProcessSelMaterialNames</span> <span class="p">)</span>

 <span class="c1">-- Just look at the first value in the array.</span>
 <span class="kr">for</span> <span class="n">i</span><span class="p">,</span><span class="n">k</span> <span class="kr">in</span> <span class="nb">ipairs</span><span class="p">(</span><span class="n">selMaterialNames</span><span class="p">)</span> <span class="kr">do</span>
     <span class="c1">-- Process &#39;k&#39; (the material name) here</span>
 <span class="kr">end</span>
<span class="o">&lt;/</span><span class="n">syntaxhighlight</span> <span class="o">&gt;</span>

<span class="o">===</span> <span class="n">lxqt</span><span class="p">()</span> <span class="o">===</span>

<span class="n">The</span> <span class="s1">&#39;&#39;&#39;lxqt&#39;&#39;&#39;</span> <span class="kr">function</span> <span class="nf">queries</span> <span class="s">[[Command System: Basics#ToggleValue Arguments|ToggleValue]]</span> <span class="n">commands</span> <span class="n">like</span> <span class="s1">&#39;&#39;</span><span class="n">tool</span><span class="p">.</span><span class="n">set</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">returning</span> <span class="n">a</span> <span class="n">simple</span> <span class="s1">&#39;&#39;</span><span class="kc">true</span><span class="s1">&#39;&#39;</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="kc">false</span><span class="s1">&#39;&#39;</span> <span class="n">value</span><span class="p">.</span> <span class="s1">&#39;&#39;</span><span class="n">lxq</span><span class="s1">&#39;&#39;</span> <span class="n">can</span> <span class="n">be</span> <span class="n">used</span> <span class="n">to</span> <span class="n">get</span> <span class="n">the</span> <span class="n">current</span> <span class="n">actual</span> <span class="n">value</span> <span class="n">of</span> <span class="n">a</span> <span class="s1">&#39;&#39;</span><span class="n">ToggleValue</span><span class="s1">&#39;&#39;</span> <span class="n">command</span><span class="p">,</span> <span class="n">which</span> <span class="n">can</span> <span class="n">be</span> <span class="n">of</span> <span class="n">any</span> <span class="n">datatype</span> <span class="ow">and</span> <span class="n">can</span> <span class="n">be</span> <span class="n">one</span> <span class="n">of</span> <span class="n">a</span> <span class="n">number</span> <span class="n">of</span> <span class="n">possible</span> <span class="n">values</span> <span class="n">depending</span> <span class="n">on</span> <span class="n">the</span> <span class="n">command</span><span class="p">.</span> <span class="s1">&#39;&#39;</span><span class="n">lxqt</span><span class="s1">&#39;&#39;</span> <span class="n">can</span> <span class="n">be</span> <span class="n">used</span> <span class="n">to</span> <span class="n">more</span> <span class="n">easily</span> <span class="n">see</span> <span class="kr">if</span> <span class="n">the</span> <span class="n">commands</span> <span class="n">is</span> <span class="s2">&quot;on&quot;</span> <span class="ow">or</span> <span class="ow">not</span><span class="p">.</span> <span class="n">This</span> <span class="n">example</span> <span class="n">checks</span> <span class="n">to</span> <span class="n">see</span> <span class="kr">if</span> <span class="n">the</span> <span class="s1">&#39;&#39;</span><span class="n">Cube</span><span class="s1">&#39;&#39;</span> <span class="n">tool</span> <span class="n">is</span> <span class="n">currently</span> <span class="n">active</span><span class="p">.</span>

 <span class="o">&lt;</span><span class="n">syntaxhighlight</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;lua&quot;</span><span class="o">&gt;</span>
 <span class="c1">-- lua</span>

 <span class="n">isActive</span> <span class="o">=</span> <span class="n">lxqt</span><span class="p">(</span> <span class="s2">&quot;tool.set prim.cube on&quot;</span> <span class="p">)</span>
<span class="o">&lt;/</span><span class="n">syntaxhighlight</span> <span class="o">&gt;</span>

<span class="o">===</span> <span class="n">lxeval</span><span class="p">()</span> <span class="o">===</span>

<span class="n">The</span> <span class="s1">&#39;&#39;&#39;lxeval&#39;&#39;&#39;</span> <span class="kr">function</span> <span class="nf">is</span> <span class="n">a</span> <span class="n">hyrid</span> <span class="n">of</span> <span class="s1">&#39;&#39;</span><span class="n">lx</span><span class="s1">&#39;&#39;</span> <span class="ow">and</span> <span class="s1">&#39;&#39;</span><span class="n">lxq</span><span class="s1">&#39;&#39;</span><span class="p">.</span> <span class="n">If</span> <span class="n">the</span> <span class="n">command</span> <span class="n">string</span> <span class="n">contains</span> <span class="n">a</span> <span class="n">question</span> <span class="n">mark</span><span class="p">,</span> <span class="n">the</span> <span class="n">command</span> <span class="n">will</span> <span class="n">be</span> <span class="n">queried</span> <span class="ow">and</span> <span class="n">returned</span><span class="p">;</span> <span class="n">otherwise</span><span class="p">,</span> <span class="n">the</span> <span class="n">command</span> <span class="n">is</span> <span class="n">executed</span> <span class="ow">and</span> <span class="n">success</span> <span class="ow">or</span> <span class="n">failure</span> <span class="n">is</span> <span class="n">returned</span><span class="p">.</span>  <span class="n">As</span> <span class="n">with</span> <span class="s1">&#39;&#39;</span><span class="n">lxq</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">querying</span> <span class="n">with</span> <span class="s1">&#39;&#39;</span><span class="n">lxeval</span><span class="s1">&#39;&#39;</span> <span class="n">will</span> <span class="n">always</span> <span class="kr">return</span> <span class="n">a</span> <span class="n">table</span><span class="p">.</span>

<span class="o">&lt;</span><span class="n">syntaxhighlight</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;lua&quot;</span><span class="o">&gt;</span>
 <span class="o">#</span> <span class="n">lua</span>

 <span class="c1">-- Execute</span>
 <span class="n">lxeval</span><span class="p">(</span> <span class="s2">&quot;user.defNew MyValue&quot;</span> <span class="p">)</span>
 <span class="n">lxeval</span><span class="p">(</span> <span class="s2">&quot;user.value MyValue {Test Value}&quot;</span> <span class="p">)</span>

 <span class="c1">-- Query</span>
 <span class="n">value</span> <span class="o">=</span> <span class="n">lxeval</span><span class="p">(</span> <span class="s2">&quot;user.value MyValue ?&quot;</span> <span class="p">)</span>
 <span class="kr">if</span> <span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="kr">then</span>
     <span class="c1">-- Do something here</span>
 <span class="kr">end</span>
<span class="o">&lt;/</span><span class="n">syntaxhighlight</span> <span class="o">&gt;</span>

<span class="o">===</span> <span class="n">lxok</span><span class="p">()</span> <span class="ow">and</span> <span class="n">lxres</span><span class="p">()</span> <span class="o">===</span>

<span class="n">The</span> <span class="n">results</span> <span class="n">of</span> <span class="s1">&#39;&#39;</span><span class="n">lx</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="n">lxq</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="n">lxqt</span><span class="s1">&#39;&#39;</span> <span class="ow">and</span> <span class="s1">&#39;&#39;</span><span class="n">lxeval</span><span class="s1">&#39;&#39;</span> <span class="n">can</span> <span class="n">be</span> <span class="n">tested</span> <span class="n">with</span> <span class="s1">&#39;&#39;</span><span class="n">lxok</span><span class="s1">&#39;&#39;</span> <span class="ow">and</span> <span class="s1">&#39;&#39;</span><span class="n">lxres</span><span class="s1">&#39;&#39;</span><span class="p">.</span> <span class="s1">&#39;&#39;&#39;lxok&#39;&#39;&#39;</span> <span class="n">returns</span> <span class="s1">&#39;&#39;</span><span class="mi">1</span><span class="s1">&#39;&#39;</span> <span class="kr">if</span> <span class="n">the</span> <span class="n">last</span> <span class="n">call</span> <span class="n">was</span> <span class="n">successful</span> <span class="ow">and</span> <span class="s1">&#39;&#39;</span><span class="mi">0</span><span class="s1">&#39;&#39;</span> <span class="kr">if</span> <span class="ow">not</span><span class="p">.</span> <span class="s1">&#39;&#39;&#39;lxres&#39;&#39;&#39;</span> <span class="n">returns</span> <span class="n">the</span> <span class="n">LxResult</span> <span class="n">code</span><span class="p">,</span> <span class="n">which</span> <span class="n">provides</span> <span class="n">more</span> <span class="n">specific</span> <span class="n">details</span> <span class="n">about</span> <span class="n">result</span> <span class="n">of</span> <span class="n">the</span> <span class="n">commands</span> <span class="n">execution</span><span class="p">.</span> <span class="n">A</span> <span class="n">list</span> <span class="n">of</span> <span class="n">standard</span> <span class="n">result</span> <span class="n">codes</span> <span class="ow">and</span> <span class="n">their</span> <span class="n">meanings</span> <span class="n">can</span> <span class="n">be</span> <span class="n">found</span> <span class="kr">in</span> <span class="n">the</span> <span class="nb">error</span> <span class="n">codes</span> <span class="n">message</span> <span class="n">table</span><span class="p">,</span> <span class="s">[[msglxresult.cfg|resource:msglxresult.cfg]]</span>

<span class="o">&lt;</span><span class="n">syntaxhighlight</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;lua&quot;</span><span class="o">&gt;</span>
 <span class="c1">-- Lua</span>

 <span class="n">isOK</span> <span class="o">=</span> <span class="n">lxok</span>
 <span class="n">result</span> <span class="o">=</span> <span class="n">lxres</span>
<span class="o">&lt;/</span><span class="n">syntaxhighlight</span> <span class="o">&gt;</span>

<span class="o">===</span> <span class="n">lxtrace</span><span class="p">()</span> <span class="o">===</span>

<span class="n">The</span> <span class="s1">&#39;&#39;&#39;lxtrace&#39;&#39;&#39;</span> <span class="kr">function</span> <span class="nf">toggles</span> <span class="n">tracing</span> <span class="n">on</span> <span class="ow">and</span> <span class="n">off</span><span class="p">.</span> <span class="n">When</span> <span class="n">tracing</span> <span class="n">is</span> <span class="n">enabled</span><span class="p">,</span> <span class="n">all</span> <span class="n">commands</span> <span class="n">executed</span> <span class="ow">or</span> <span class="n">queried</span>  <span class="n">by</span> <span class="s1">&#39;&#39;</span><span class="n">lx</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="n">lxq</span><span class="s1">&#39;&#39;</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">other</span> <span class="n">execute</span><span class="o">/</span><span class="n">query</span> <span class="n">functions</span> <span class="n">are</span> <span class="n">output</span> <span class="n">to</span> <span class="n">the</span> <span class="s1">&#39;&#39;</span><span class="n">Scripting</span><span class="s1">&#39;&#39;</span> <span class="n">sub</span><span class="o">-</span><span class="n">system</span> <span class="n">of</span> <span class="n">the</span> <span class="s1">&#39;&#39;</span><span class="n">Event</span> <span class="n">Log</span><span class="s1">&#39;&#39;</span> <span class="n">viewport</span><span class="p">.</span> <span class="n">This</span> <span class="n">can</span> <span class="n">also</span> <span class="n">be</span> <span class="n">used</span> <span class="n">to</span> <span class="n">see</span> <span class="kr">if</span> <span class="n">tracing</span> <span class="n">is</span> <span class="n">on</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">by</span> <span class="ow">not</span> <span class="n">passing</span> <span class="kr">in</span> <span class="n">an</span> <span class="n">argument</span><span class="p">.</span>

<span class="o">&lt;</span><span class="n">syntaxhighlight</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;lua&quot;</span><span class="o">&gt;</span>
 <span class="c1">-- lua</span>

 <span class="n">isTracing</span> <span class="o">=</span> <span class="n">lxtrace</span><span class="p">()</span>
 <span class="n">lxtrace</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>              <span class="c1">-- Turn on tracing</span>
<span class="o">&lt;/</span><span class="n">syntaxhighlight</span> <span class="o">&gt;</span>

<span class="o">===</span> <span class="n">lxout</span><span class="p">()</span> <span class="o">===</span>

<span class="n">The</span> <span class="s1">&#39;&#39;&#39;lxout&#39;&#39;&#39;</span> <span class="kr">function</span> <span class="nf">can</span> <span class="n">be</span> <span class="n">used</span> <span class="n">to</span> <span class="n">output</span> <span class="n">debugging</span> <span class="n">information</span> <span class="n">to</span> <span class="n">the</span> <span class="s1">&#39;&#39;</span><span class="n">Scripting</span><span class="s1">&#39;&#39;</span> <span class="n">sub</span><span class="o">-</span><span class="n">system</span> <span class="n">of</span> <span class="n">the</span> <span class="n">Event</span> <span class="n">Log</span> <span class="n">viewport</span><span class="p">,</span> <span class="ow">and</span> <span class="n">can</span> <span class="n">be</span> <span class="n">any</span> <span class="n">string</span><span class="p">.</span>

<span class="o">&lt;</span><span class="n">syntaxhighlight</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;lua&quot;</span><span class="o">&gt;</span>
 <span class="c1">-- lua</span>

 <span class="n">lxout</span><span class="p">(</span> <span class="s2">&quot;My Debug Output&quot;</span> <span class="p">)</span>
<span class="o">&lt;/</span><span class="n">syntaxhighlight</span> <span class="o">&gt;</span>

<span class="n">Here</span><span class="s1">&#39;s another example that outputs the first element of a table representing the number of items in a scene through &#39;&#39;lxout&#39;&#39;.</span>

<span class="s1">&lt;syntaxhighlight lang=&quot;lua&quot;&gt;</span>
<span class="s1"> -- lua</span>

<span class="s1">  n = lxq( &quot;query sceneservice item.N ? all&quot; )</span>
<span class="s1">  lxout( n[1]..&quot; items in scene.&quot; )</span>
<span class="s1">&lt;/syntaxhighlight &gt;</span>

<span class="s1">=== lxoption() and lxsetOption() ===</span>
<span class="s1">The &#39;&#39;&#39;</span><span class="n">lxoption</span><span class="s1">&#39;&#39;&#39; and &#39;&#39;&#39;</span><span class="n">lxsetOption</span><span class="s1">&#39;&#39;&#39; functions allow the script to set properties that determine how the other &#39;&#39;lx&#39;&#39; functions operate. Each option is defined by a tag string and an associated value, and the options can be changed at any time.</span>

<span class="s1">Currently there is only one tag defined, &#39;&#39;&#39;</span><span class="n">queryAnglesAs</span><span class="s1">&#39;&#39;&#39;, which determines if angles queried through &#39;&#39;lxq&#39;&#39; are returned in radians or degrees. This defaults to degrees to maintain backwards compatibility with previous versions of &#39;&#39;modo&#39;&#39;. While this behavior is helpful for new scripters, it is generally more useful to work in radians. The value can be set to either radians or degrees, and once set all future queries on angles through &#39;&#39;lxq&#39;&#39; will return those units.  The following shows how to change this option and query its current state.</span>

<span class="s1">&lt;syntaxhighlight lang=&quot;lua&quot;&gt;</span>
<span class="s1"> -- lua</span>

<span class="s1"> lxsetOption( &quot;queryAnglesAs&quot;, &quot;radians&quot; )</span>
<span class="s1"> lxout( lxoption( &quot;queryAnglesAs&quot; ) )</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="arguments">
<h2><a class="toc-backref" href="#id3">Arguments</a><a class="headerlink" href="#arguments" title="Permalink to this headline">¶</a></h2>
<p>Arguments passed to a Lua script are handled in the same way as they are in a stand-alone Lua script. The global <em>arg</em> table contains all of the arguments, as well as the path to the script at key 0, which is standard Lua practice.  The key 0 is not included in the total number of arguments.  This means that <em>#arg</em> will return 0 if you execute a Lua script without passing any arguments to it, even though key 0 is always the script’s path.</p>
<p>This simple example outputs all of the arguments to the Event Log.</p>
<div class="highlight-lua notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="c1">-- lua</span>

 <span class="n">lxout</span><span class="p">(</span> <span class="s2">&quot;Script Path (arg[[0]): &quot;</span><span class="o">..</span><span class="n">arg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">);</span>
 <span class="n">lxout</span><span class="p">(</span> <span class="s2">&quot;Number of Arguments (#arg):  &quot;</span><span class="o">..#</span><span class="n">arg</span> <span class="p">);</span>
 <span class="kr">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="kr">in</span> <span class="nb">pairs</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="kr">do</span>
     <span class="n">lxout</span><span class="p">(</span> <span class="s2">&quot;Arg &quot;</span><span class="o">..</span><span class="n">k</span><span class="o">..</span><span class="s2">&quot;: &quot;</span><span class="o">..</span><span class="n">v</span> <span class="p">)</span>
 <span class="kr">end</span>
</pre></div>
</td></tr></table></div>
<p>When executed like so:</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="nd">@C</span><span class="p">:</span>\<span class="n">args</span><span class="o">.</span><span class="n">lua</span> <span class="n">a</span> <span class="n">b</span>
</pre></div>
</td></tr></table></div>
<p>the above would output the following to the Event Log:</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="n">Script</span> <span class="n">Path</span> <span class="p">(</span><span class="n">arg</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span> <span class="n">C</span><span class="p">:</span>\<span class="n">args</span><span class="o">.</span><span class="n">lua</span>
 <span class="n">Number</span> <span class="n">of</span> <span class="n">Arguments</span> <span class="p">(</span><span class="nd">@arg</span><span class="p">):</span> <span class="mi">2</span>
 <span class="n">Arg</span> <span class="mi">1</span><span class="p">:</span> <span class="n">a</span>
 <span class="n">Arg</span> <span class="mi">2</span><span class="p">:</span> <span class="n">b</span>
 <span class="n">Arg</span> <span class="mi">0</span><span class="p">:</span> <span class="n">C</span><span class="p">:</span>\<span class="n">args</span><span class="o">.</span><span class="n">lua</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="exiting-with-error">
<h2><a class="toc-backref" href="#id4">Exiting with error</a><a class="headerlink" href="#exiting-with-error" title="Permalink to this headline">¶</a></h2>
<p>A script can exit early by calling the Lua <strong>error</strong> function.  This will open a dialog displaying the error message.</p>
<div class="highlight-lua notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="c1">-- lua</span>

 <span class="kr">if</span><span class="p">(</span> <span class="o">#</span><span class="n">arg</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="p">)</span>
     <span class="nb">error</span> <span class="s2">&quot;Failed&quot;</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="progress-monitors">
<h2><a class="toc-backref" href="#id5">Progress Monitors</a><a class="headerlink" href="#progress-monitors" title="Permalink to this headline">¶</a></h2>
<p>Progress bars, or ‘’monitors’’, are also supported in Lua through the <em>lxmonInit</em> and <em>lxmonStep</em> functions.</p>
<div class="section" id="lxmoninit">
<h3><a class="toc-backref" href="#id6">lxmonInit()</a><a class="headerlink" href="#lxmoninit" title="Permalink to this headline">¶</a></h3>
<p>To initialize the progress bar, call <strong>lxmonInit</strong> with the total number of steps in the bar. <strong>lxmonInit</strong> should be called only once per script.</p>
<div class="highlight-lua notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63</pre></div></td><td class="code"><div class="highlight"><pre><span></span> -- lua

 lxmonInit( 20 )
&lt;/syntaxhighlight &gt;

=== lxmonStep() ===
To step the progress bar, use lxmonStep. By default, this increments the bar one step, but you can also increase the
bar by an arbitrary number steps.

&lt;syntaxhighlight lang=&quot;lua&quot;&gt;
 -- lua

 lxmonInit( 20 )

 lmonStep()        -- Increment by one
 lxmonStep( 2 )   - Step the progress bar by two
&lt;/syntaxhighlight &gt;

The return value of &#39;&#39;lxmonStep&#39;&#39; is used by the script to determine if the hit the &quot;abort&quot; button in the progress dialog. If &#39;&#39;lxmonStep&#39;&#39; returns false, the script should abort. The following is a common test for a user abort.

&lt;syntaxhighlight lang=&quot;lua&quot;&gt;
 -- lua

 -- Initialize the monitor
 lxmonInit( 20 );

 for i = 0; i &lt; 20;  i++ do

    -- Do work here

    -- Step the monitor and check for an abort
    if !lxmonStep()  then
        -- Do clean-up here
        error &quot;User Abort&quot;;
    end

 end
&lt;/syntaxhighlight &gt;

=== Monitor Example ===

This simple script demonstrates progress bars through the use of monitors. It busy loops so the progress bar will open. If the script executes fast enough, the progress bar will not appear.

&lt;syntaxhighlight lang=&quot;lua&quot;&gt;
 -- lua

 -- Initialize the monitor with 20 steps
 lxmonInit( 200 );

 -- Loop through our 200 steps
 for i=0,200 do

     -- Do work (i.e.: busy loop )
     for j=0,1000000  do
         ;
     end

     -- Step the monitor and check for an abort
     if !lxmonstep() then
         -- Clean up and exit
         error &quot;User Abort&quot;;
     end
 end
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="more-information">
<h2><a class="toc-backref" href="#id7">More Information</a><a class="headerlink" href="#more-information" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="Scripting.html"><span class="doc">Scripting</span></a></p></li>
<li><p><a class="reference internal" href="../general/systems/Command%20System.html"><span class="doc">Command System</span></a></p></li>
<li><p>Script Examples</p></li>
<li><p>Scripting Languages</p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Macros.html" class="btn btn-neutral float-right" title="Macros" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Layerservice.html" class="btn btn-neutral float-left" title="Layerservice" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Foundry

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org/">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>

<!-- Mirrored from learn.foundry.com/modo/developers/latest/sdk/pages/scripting/Lua.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 30 Nov 2024 03:16:00 GMT -->
</html>